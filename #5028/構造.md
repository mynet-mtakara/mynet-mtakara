## 実際の環境

```
@startuml
package 実行環境 {
package フレームワーク {
map コード {
}
}
}
@enduml
note left of 実行環境 : 本案や開発環境
```

## テスト環境

```
@startuml
package 実行環境 {
package ユニットテスト {
map コード {
}

}
}
@enduml
note left of 実行環境 : ローカルや札幌サーバ
note bottom of ユニットテスト : データや時間などテストしたい状況を作る
```
- コード側は実際に動く環境と同じコードで変えないようにする
- ユニットテスト側（テスト側）で実際に動いてる状況（テストしたい）を作る

## ユニットテストの勘違いしやすいところ
- 負荷試験とは違う（負荷試験は別に用意すべき）
-  テストは速い方が良い（1時間で100テスオより1分で1000 テストの方がよい）
  - ループなどはできるだけしない
  - テストデータを数件程度にする（不要データ削除、何百件もテストで使わない）
- できるだけ小さく作る
  - 通常コントローラー方がモデルよりも関係範囲も必要データも多くなる。なるべくモデルをテストするようにする（現状はコントローラーテストの用意がない）
- ロジックはモデル側に入れていく
  - どこから呼ばれても同じ結果にするために必要（モデル側ではクッキーを扱ったり、HTMLを返却せずクッキーの値を引数にしたり、配列で返すようにする）
  - なるべく同じコードは共通化していく（ユニットテスト向き）
## テストの目的と効果
- テストの実行時間（少なくともテストを実行した箇所はシンタックスエラーがない）
- 改修の際に思いっきり修正できる（テストで同じ結果になることが保証される安心）
- 影響の出る範囲がテスト結果によりアラートになる（テストNGの状態にしないようにする）
## テストの範囲（実装の目安）
決めの問題なので、こうでなければいけないというのはない。なので良くある例
- 1ファイルに最低1テスト（文法エラーを防ぐ？）
- コードカバレッジ100％（理想ではあるが実現してるのは見たことない）
- 不具合修正の際には必ずテスト駆動型にする（同じ不具合は出ないようにする）
## MVCについて
- そもそもというところもあるが、そもそものMVC、共通化によるテストの考え方の整理
- ZendFrameworkが古めのフレームワークというのと10年前の実装、フレームワーク中でも自由度が高いため今時としては一般的でない部分が多々ある
  - MVCについてはググる大量にヒットする[MVCモデルについて](https://qiita.com/s_emoto/items/975cc38a3e0de462966a)

